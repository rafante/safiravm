---
version: "3"
services: 
    mysql:
        image: mysql:5.6
        container_name: mysql-container
        ports: 
            - "3306:3306"
        volumes: 
            - .data:/var/lib/mysql
        environment: 
            - MYSQL_ROOT_PASSWORD=SafiraLabApp
            - MYSQL_DATABASE=safira
        networks: 
            - backend
    registry:
        image: registry:2
        container_name: docker-registry-container
        ports: 
            - 5000:5000
        restart: always
        volumes: 
            - .volume:/var/lib/registry
    registry-ui:
        image: konradkleine/docker-registry-frontend:v2
        container_name: docker-registry-ui-container
        ports: 
            - 8081:80
        environment:
            ENV_DOCKER_REGISTRY_HOST: docker-registry
            ENV_DOCKER_REGISTRY_PORT: 5000
    safira-api:
        build: ./backend
        container_name: safira-api-container
        networks:
            - backend
            - frontend
        ports: 
            - 8080:8080
        depends_on: 
            - "mysql"
    safira-front:
        build: ./frontend
        container_name: safira-front-container
        networks: 
            - frontend
        ports: 
            - 3000:3000
networks:
    frontend:
        driver: bridge
    backend:
        driver: bridge